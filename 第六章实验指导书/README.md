# 第六章：进程管理 - 指导书目录

## 章节结构

### 6.1 进程控制块 (PCB)

- **6.1.1 进程概念与PCB设计** ✅
  - 理解进程的基本概念
  - 设计Process结构体框架
  - 了解PCB的作用

- **6.1.2 实现PID分配器** ✅
  - 使用原子操作实现线程安全的PID分配
  - Newtype模式封装PID
  - 实现PID相关辅助方法

- **6.1.3 定义进程状态枚举** ✅
  - 定义四种进程状态
  - 实现状态转换验证
  - 实现Display trait

- **6.1.4 实现进程上下文保存** ✅
  - 定义ProcessContext结构体
  - 保存34个寄存器（31个通用 + 3个CSR）
  - 为上下文切换做准备

- **6.1.5 实现PCB完整结构** ✅
  - 实现ProcessControlBlock完整定义
  - 实现PCB的创建和销毁
  - 实现辅助方法（状态管理、时间片等）

### 6.2 上下文切换

- **6.2.1 上下文切换（上）- 机制讲解** ✅
  - 理解为什么需要上下文切换
  - 理解切换的完整流程
  - RISC-V寄存器保存与恢复

- **6.2.2 上下文切换（下）- 汇编实现** ✅
  - 用汇编实现寄存器保存
  - 实现`__switch`核心函数
  - 栈帧布局设计
  - 实现寄存器恢复和页表切换

### 6.3 进程调度

- **6.3.1 调度器设计** ✅
  - 理解调度的目标
  - 设计调度器接口
  - 实现就绪队列

- **6.3.2 轮转调度实现** ✅
  - 实现Round-Robin调度
  - 实现进程选择逻辑
  - 配置时钟中断
  - 实现时间片消耗和进程切换

### 6.4 进程生命周期

- **6.4.1 进程创建（fork）** 📝 待重写
  - 实现fork系统调用
  - 复制地址空间
  - 父子进程关系建立

- **6.4.2 进程执行（exec）** 📝 待重写
  - 实现exec系统调用
  - 加载ELF文件
  - 替换地址空间

- **6.4.3 进程退出（exit）** 📝 待重写
  - 实现exit系统调用
  - 转为Zombie状态
  - 资源回收

- **6.4.4 进程等待（wait）** 📝 待重写
  - 实现wait系统调用
  - 回收僵尸进程
  - 获取退出码

---

## 当前进度

### 已完成 ✅
- **6.1 进程控制块 (PCB)** - 全部完成
  - 6.1.1 进程概念与PCB设计
  - 6.1.2 实现PID分配器
  - 6.1.3 定义进程状态枚举
  - 6.1.4 实现进程上下文保存
  - 6.1.5 实现PCB完整结构

- **6.2 上下文切换** - 全部完成
  - 6.2.1 上下文切换（上）- 机制讲解
  - 6.2.2 上下文切换（下）- 汇编实现

- **6.3 进程调度** - 全部完成
  - 6.3.1 调度器设计
  - 6.3.2 轮转调度实现

### 待完成 📝
- 6.4.x 进程生命周期系列（根据用户要求，暂不编写）

---

## 写作风格要求

1. **短代码段**：每个代码块10-30行
2. **HTML折叠**：完整代码用`<details>`折叠
3. **代码外讲解**：复杂算法在代码块外详细解释
4. **文件结构**：每节开头列出新增文件
5. **无可视化代码**：测试代码不包含可视化内容

---

## 依赖关系

```
6.1.2 PID分配器
  ↓
6.1.3 进程状态枚举
  ↓
6.1.4 进程上下文
  ↓
6.1.5 PCB完整结构
  ↓
6.2 上下文切换
  ↓
6.3 进程调度
  ↓
6.4 进程生命周期
```

按顺序学习，每节独立可测试。
